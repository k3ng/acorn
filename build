#!/bin/bash
F=$@
WORKING_DIRECTORY=`pwd`


if [[ $F = "" ]]; then
	F="acorn"
fi

if [ -e ./release_notes.txt ]; then
  echo -e "\r\n\r\n"
	cat ./release_notes.txt
fi

if [ "$F" = "acorn" ]; then
  VERSION=`grep VER acorn.h|awk 'FNR==1{print $4}'|sed -e 's/"//g'`
  echo "compiling $F version $VERSION in $WORKING_DIRECTORY"
  gcc -D COMPILING_EVERYTHING -g -o $F debug.c ini.c sound.c fft_filter.c vfo.c sdr.c modems.c tcpserver.c $F.c -lwiringPi -lasound -lm -lfftw3 -lfftw3f -pthread 
fi


if [ "$F" = "acorn-gtk-client" ]; then
  VERSION=`grep VER acorn-gtk-client.h|awk 'FNR==1{print $4}'|sed -e 's/"//g'`
  echo "compiling $F version $VERSION in $WORKING_DIRECTORY"
  gcc -g -o $F ini.c $F.c -lm -lwiringPi -lfftw3 -lfftw3f -pthread -lncurses `pkg-config --cflags gtk+-3.0` `pkg-config --libs gtk+-3.0`
fi
